1) Diagnóstico do motor atual
Leia o código atual de sugestão de PCP.
Explique objetivamente:
regras de prioridade
como calcula demanda/venda/estoque/autonomia
como aplica capacidade e produtividade
Aponte limitações e onde o modelo pode gerar PCP subótimo.
2) Projeção de estoque sequencial (obrigatório)
Manter a regra:
PCP 1 usa o estoque atual real.
PCP 2+ usam estoque final projetado da semana anterior.
Para cada produto e semana: EstoqueFinal = EstoqueInicial + Produção - VendaPrevista
E o EstoqueFinal de uma semana vira EstoqueInicial da próxima (semanas marcadas/confirmadas entram na projeção).
3) Modelagem correta de capacidade por linha (machine-hours)
Cada linha tem:
horas_semana
qtd_maquinas
capacidade total = horas_semana * qtd_maquinas (em MH)
Cada produto tem (por linha compatível):
taxa_producao_por_maquina (kg/h por máquina, ou un/h por máquina)
Então:
Produção possível em uma linha = MH_disponivel * taxa_producao_por_maquina
E para produzir uma quantidade Q: MH_consumidos = Q / taxa_producao_por_maquina
Implementar tudo usando essa lógica (MH), não “capacidade em kg” fixa.
4) Score analítico de prioridade (motor de decisão)
Quero ranking por produto com um Priority Score, composto por:
(A) Risco de ruptura
Se autonomia projetada < autonomia_meta (ex.: 40 dias), score sobe.
Se estoque projetado ficar negativo em alguma semana, prioridade máxima.
Se tendência de venda aumentando, elevar score.
(B) Giro / demanda
produtos com maior venda média sobem no ranking.
(C) Eficiência produtiva por linha
preferir alocar onde o produto consome menos MH para gerar o mesmo volume (maior kg/h por máquina).
se produto só roda em 1 linha, aumentar peso do risco (porque é mais restrito).
(D) Estratégia de estoque
autonomia_meta (padrão 40 dias, editável pelo admin)
teto_autonomia (ex.: 50–60 dias) para evitar excesso sem motivo
zona confortável: se autonomia >= teto, score vai a zero (a menos que haja sobra de MH e seja estratégia).
Deixar os pesos configuráveis (admin).
5) Alocação de produção por linha (algoritmo obrigatório)
Construir um algoritmo de alocação que:
Entradas:
lista de produtos
estoques atuais
vendas previstas por semana
metas de autonomia
linhas com (horas_semana, qtd_maquinas)
produtividade por produto por linha (kg/h por máquina)
compatibilidade produto↔linha
Saídas:
PCP sugerido por semana
quantidade sugerida por produto
distribuição por linha
consumo de MH por linha e % de utilização
Regras:
Respeitar compatibilidades (produto só em linhas permitidas).
Não ultrapassar MH disponível por linha na semana.
Se MH insuficiente para atender todos:
produzir primeiro maiores scores
reduzir/zerar itens confortáveis
gerar alerta: “capacidade insuficiente para atingir autonomia alvo” e listar itens impactados.
Considerar penalidade de “troca/setup” como parâmetro opcional:
penalizar produzir pequenas quantidades de muitos itens na mesma linha.
se não houver dado, implementar um valor default configurável.
Implementação sugerida:
abordagem greedy por score + restrições de MH (simples e confiável), mas organizada para evoluir depois.
6) Explicabilidade (obrigatório)
Para cada produto sugerido, mostrar:
Score total e componentes (ruptura/giro/eficiência/estoque)
autonomia atual vs autonomia pós-sugestão
estoque projetado sem produzir vs com produzir
linha escolhida e justificativa (maior produtividade / menor MH)
MH consumidos e capacidade restante da linha
7) Central de alertas e botões de semana (obrigatório)
Botão de selecionar semana só aparece se a semana tiver programação.
Só pode selecionar semana N se N-1 estiver selecionada (não pode pular).
Ao marcar/desmarcar, recalcular projeções e sugestões seguintes.
8) Entregas (obrigatório)
Refatorar com funções claras:
calcularProjecaoEstoqueSequencial()
calcularAutonomia()
calcularScorePrioridade()
alocarPorMachineHours()
gerarExplicacaoSugestao()
Criar uma aba “Análise do PCP” com:
ranking + score
uso de capacidade por linha (MH e %)
alertas de ruptura e de capacidade
explicações por produto
Não simplificar. Não recalcular semanas isoladas. Toda projeção é encadeada.